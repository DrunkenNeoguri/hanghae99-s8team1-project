import React, { useState, useEffect, useRef } from 'react';
import './Home.css'; 

const colors = ["A", "B", "C"];
const delay = 2500;

function Home(){
  const [loading, setLoading] = useState(true);
  const [slideidx, setSlideidx] = useState(0);
  const timeoutRef = useRef(null);

  console.log(timeoutRef);
  // useState를 이용하면 렌더링을 진행하지만, useRef를 이용하면 렌더링은 진행되지 않음.
  // 단, useRef의 변화는 적용되고 있음. 렌더링만 되지 않았을 뿐.
  function resetTimeOut () {
    if (timeoutRef.current) {
      console.log(timeoutRef, timeoutRef.current)
      clearTimeout(timeoutRef.current);
    }
  }
  useEffect (() => {
    setLoading(false)
  }, []);

  useEffect (() => {
    resetTimeOut();
    timeoutRef.current = setTimeout(
      () =>
        setSlideidx((previousIdx) =>
          previousIdx === colors.length -1 ? 0 : previousIdx +1),
          delay
        );

        return () => {
          resetTimeOut();
        };
  }, [slideidx]);

  return(
    <div className="container">
    {loading ? <div className="Loading">Loading...</div> : 
      <>
        <div className="container">
          <div className="container--menu">모두의 영화</div>
          <div className="container--Slideshow"></div>
          <div className="container--body">
            <h1 className="container--body__header">어떤 영화를 볼지 고민되시나요?</h1>
            <p className="container--body__paragraph">다음 테스트를 진행해보세요! 당신의 마음에 맞는 현재 개봉중인 영화를 골라드립니다!</p>
            <button className="container--body__btn">시작하기</button>
          </div>
        </div>
      </>}
    </div>
    );
}

export default Home;